# 摘要

本文介绍了一种基于图的文本处理排序模型TextRank，并展示了该模型如何成功地应用于自然语言应用。提出了两种创新的无监督关键字和句子提取方法，并表明所获得的结果与之前在既定基准上发表的结果相比更有利。

# 一、介绍

基于图的排序算法是一种决定图中顶点重要性的方法，它考虑从整个图中递归计算出的全局信息，而不仅仅依赖于特定于局部顶点的信息。

将类似的思路应用于从自然语言文档中提取的词汇或语义图，可以得到一个基于图的排名模型，该模型可应用于各种自然语言处理应用程序，其中从整个文本中提取的知识可用于进行局部排名/选择决策。这种面向文本的排序方法可以应用于从关键短语的自动提取到提取摘要和词义消歧等任务。

本文介绍了基于TextRank的图形排序模型，用于从自然语言文本中提取图形。TextRank在两个由无监督关键字和句子提取组成的语言处理任务中的应用中具有较强的竞争力。

# 二、TextRank模型

> 基于图的排序算法本质上是一种基于从整个图中递归提取的全局信息来决定图中顶点重要性的方法。

基于图表的排名模型实现的基本思想是“投票”或“推荐”。当一个顶点链接到另一个顶点时，它基本上是为另一个顶点投了一票。投给一个顶点的票数越高，该顶点的重要性就越高。此外，投选票($d$)的顶点的重要性决定了投票本身($1-d$)的重要性，排名模型也会考虑到这些信息。因此，与一个顶点相关的分数是基于投给它的选票和投这些选票的顶点的分数来确定的。

理论上，设$G=(V,E)$是一个有向图，其中$V$是顶点的集合、$E$是边的集合，且$E$是$V\times V$的子集。对于一个给定的顶点$V_i$，设$In(V_i)$是指向它的顶点集(即祖先节点)，设$Out(V_i)$是顶点$V_i$指向的顶点的集合(即子孙节点)。顶点$V_i$的得分被定义为：
$$
S(V_i)=(1-d)+d*\displaystyle\sum_{j\in In(V_i)}\frac{1}{|Out(V_j)|}S(V_j)
$$
其中，$d$是阻尼因子，可以被设置在0到1之间，它的作用是将图中从一个给定顶点跳到另一个随机顶点的概率积分到模型中。在Web冲浪的背景下，这个基于图的排名算法实现了“随机冲浪模型”，用户以$d$的概率随机点击链接，并且以$(1-d)$的概率跳转到一个全新的页面。因子$d$通常设置成0.85，并且这也是我们在实现中使用的值。

`从分配给图中每个节点的任意值开始，计算迭代，直到收敛到给定阈值以下。`在运行算法之后，每个顶点都有一个分数，它代表了顶点在图中的“重要性”。注意，TextRank运行到完成后得到的最终值不受初始值选择的影响，只是迭代到收敛的次数可能不同。

PS：尽管本文描述的TextRank应用依赖于从谷歌的PageRank派生的算法，但其他基于图的排序算法，如HITS或位置函数等，可以很容易地集成到TextRank模型中。

## 1、无向图

基于图的递归排序算法也可以应用于无向图。在这种情况下，顶点的出度等于顶点的入度。对于松散连通图，边的数量与顶点的数量成正比，无向图往往有更渐进的收敛曲线。

图1绘制了具有250个顶点和250条边的随机生成图的收敛曲线，收敛阈值为0.0001。随着图的连通性增加(即边的数量增加)，收敛通常只需要更少的迭代就能实现，有向图和无向图的收敛曲线实际上是`重叠`的。

![1669686286503](D:%5CTypora%5Cuser-image%5C1669686286503.png)

## 2、加权图

在Web冲浪的上下文中，一个页面包含到另一个页面的多个或部分链接是不常见的，因此基于图的排名的原始PageRank定义是假设未加权的图。

然而，在TextRank模型中，图是由自然语言文本构建的，可能包括从文本中提取的单元(顶点)之间的多个或部分链接。因此，可以将两个顶点$V_i$和$V_j$之间的连接的“强度”作为一个权重$w_{ij}$添加到连接着两个顶点的对应边中，并将其纳入模型中。

因此，引入了一个新的基于图的排序公式，该公式在计算与图中顶点相关的得分时考虑到了边的权重。注意，可以定义一个类似的公式来积分顶点权重：
$$
WS(V_i)
=(1-d)+d*\displaystyle\sum_{V_j\in In(V_i)}\frac{w_{ji}}{\displaystyle\sum_{V_k\in Out(V_j)}w_{jk}}WS(V_j)
$$
图1绘制了二.1节中相同样本图的收敛曲线，并在边缘上添加了区间0-10的随机权重。虽然最终的顶点得分(因此排名)与未加权的备选方案相比有显著差异，但对于加权图和未加权图，收敛的迭代次数和收敛曲线的形状几乎相同。

## 3、作为图的文本

为了将基于图的排序算法应用到自然语言文本中，我们必须构建一个表示文本的图，并将单词或其他文本实体与有意义的关系连接起来。

根据可用的应用程序，在图中添加各种大小和特征的文本单元作为顶点，例如单词、搭配、完整的句子或者其它。同样，应用程序规定了用于在任何两个这样的顶点之间建立连接的关系类型，例如词汇或语义关系、上下文重叠等。

不管添加到图中的元素的类型和特征如何，基于图的排序算法在自然语言文本中的应用包括以下主要步骤：

1. 确定最能定义手头任务的文本单元，并将它们添加到图中。
2. 确定连接这些文本单元的关系，并使用这些关系绘制图中顶点之间的边。边可以是有向的或无向的，有权的或无权的。
3. 对这个基于图的评分算法进行迭代，直至收敛。
4. 基于顶点的最终得分对它们进行排序。使用附加到每个顶点的值进行排序或选择决策。

TextRank在两个涉及文本单元排序的自然语言处理任务中的应用：

1. 关键字提取。包括对给定文本具有代表性的关键短语的选择；
2. 句子提取。包括识别文本中最“重要”的句子，可用于构建提取摘要。

# 三、关键字提取

关键字提取的任务是在文本中自动识别一组最能描述文档的术语。这些关键字可以构成为文档集合构建自动索引的有用条目，可以用于对文本进行分类，也可以作为给定文档的简明摘要。此外，一个自动识别文本中重要术语的系统可以用于术语提取和特定领域词典的构建问题。

最简单的方法可能是使用频率准则来选择文档中的“重要”关键字。然而，这种方法通常被发现导致较差的结果。目前，这一领域的最先进的技术是监督学习方法，即训练系统根据词汇和语法特征识别文本中的关键字。

## 1、TextRank用于关键字提取

该应用的最终预期结果是一组代表给定自然语言文本的单词或短语。要排序的单位是从文本中提取的一个或多个词汇单位的序列，它们表示添加到文本图中的顶点。在两个词汇单位之间定义的任何关系都是一个有用的潜在连接(边)，可以添加到两个这样的顶点之间。

使用一个共现关系(即共同出现的关系)，由单词出现之间的距离来控制：如果两个顶点对应的词汇单位在最多N个单词的窗口内同时出现，则它们是连接的。其中，N可被设置为2到10。

共现链接表示语法元素之间的关系，与语义链接相似，语义链接用于词义消歧，它们表示给定文本的衔接指标。

添加到图中的顶点可以用语法过滤器进行限制，语法过滤器只选择特定词性的词汇单位。例如，可以只考虑将名词和动词添加到图中，从而仅根据可以建立的名词和动词之间的关系来绘制潜在的边。

> TextRank关键字提取算法是完全无监督的，并按照以下步骤进行：

1. 文本是被标记的，并使用词性标记进行注释——这是启用语法过滤器应用程序所需的预处理步骤。为了避免通过添加包含多个词汇单位(ngrams)的所有可能的序列组合而导致图的尺寸过度增长，我们只考虑`将单个单词作为候选添加到图中，而多词关键字最终将在后处理阶段重构`。
2. 将所有通过语法过滤器的词汇单位添加到图中，并在N个单词的窗口内同时出现的词汇单位之间添加一条边。在构建图(无向无权图)后，与每个顶点相关的评分被设置为初始值1，并在图上运行第二节中描述的排名算法多次迭代，直到收敛——通常为20-30次迭代，阈值为0.0001。

一旦得到图中每个顶点的最终得分，顶点将按其得分的倒序排序，并保留排名中的前T个顶点用于后处理。虽然T可以设置为任何固定的值，通常从5到20个关键字。

> 本文会使用一种更灵活的方法，它根据文本的大小决定关键字的数量。对于本文实验中使用的数据，它由相对较短的抽象组成，T被设置为图中顶点数量的三分之一。

在后处理过程中，将TextRank算法选择的所有潜在关键字的词汇单位标记在文本中，并将相邻关键字的序列分解为一个多词关键字。

![1669802772780](D:%5CTypora%5Cuser-image%5C1669802772780.png)

图2显示了为我们的测试集合中的一个抽象构建的示例图。摘要的大小从50到350字不等，平均大小为120字，我们特意选择了一个非常小的摘要作为说明的目的。对于本例，通过TextRank算法发现的具有较高“重要性”的词汇单位是(括号中显示了TextRank评分):数字(1.46)、不等式(1.45)、线性(1.29)、丢帧(1.28)、上限(0.99)、边界(0.99)、严格(0.77)。注意，这个排序不同于通过简单的词频呈现的排序。对于同一文本，频率方法提供了以下排在首位的词汇单位:系统(4)、类型(3)、解(3)、最小值(3)、线性(2)、不等式(2)、算法(2)。所有其他词汇单位的频率都是1，因此不能排序，只能列出。

## 2、评价方法

# 四、句子提取

TextRank应用程序包括用于自动摘要的句子提取。在某种程度上，句子提取的问题可以被视为类似于关键字提取的问题，因为这两个应用程序都旨在识别对给定文本更“有代表性”的序列。在关键字提取中，候选文本单元由单词或短语组成，而在句子提取中，我们处理整个句子。事实证明，TextRank非常适合这种类型的应用程序，因为它允许基于从整个文本中提取的信息递归地计算文本单元的排序。

## 1、句子提取的TextRank

要应用TextRank，我们首先需要构建一个与文本关联的图，其中图顶点代表要排序的单元。对于句子提取任务，目标是对整个句子进行排序，因此为文本中的每个句子在图中添加一个顶点。

这里不能使用关键字提取的共现关系，因为所考虑的文本单元远远大于一个或几个单词，而“共现”对于如此大的上下文来说并不是一个有意义的关系。

> 因此本文作者定义了一种不同的关系，如果两句话之间存在“相似度”关系，则该关系确定两句话之间的联系，其中“相似度”是根据它们的内容重叠程度来衡量的。

这样两个句子之间的关系可以被看作是一个“推荐”的过程:一个句子处理文本中的某些概念，给读者一个“推荐”，让他们参考文本中处理相同概念的其他句子，因此任何两个这样的句子之间都可以建立一个链接，这些句子具有共同的内容。

两个句子的重叠可以简单地确定为两个句子的词汇表示之间的公共标记的数量，也可以通过语法过滤器来运行，它只计算某一语法类别的单词，例如所有开放类单词、名词和动词等。此外，为了避免推广长句，使用了归一化因子，并且根据每个句子的长度来划分两个句子的重叠内容。

![1669812506719](D:%5CTypora%5Cuser-image%5C1669812506719.png)

![1669812519048](D:%5CTypora%5Cuser-image%5C1669812519048.png)

理论上，给定两个句子$S_i$和$S_j$，句子被含有$N_i$个单词的集合所表示，可表示为：$S_i=w_1^i,w_2^i,\dots,w_{N_i}^i$，$S_i$和$S_j$的相似性可定义为：
$$
Similarity(S_i,S_j)
=\frac{|\{w_k|w_k\in S_i \& w_k\in S_j \}|}{log(|S_i|)+log(|S_j|)}
$$
其他的句子相似度度量，如字符串核、余弦相似度、最长公共子序列等，也都是可行的。

结果图是高度连接的，每条边都有一个权重，表示文本中不同句子对之间建立的连接的强度。因此，文本被表示为一个加权图。在图上运行排名算法后，将句子按得分倒序排序，并选择排名靠前的句子纳入摘要。

图3显示了一个文本示例，以及为此文本构造的相关加权图。该图还显示了连接到顶点94的边的样本权重，以及为每个句子计算的最终TextRank评分。排名最高的句子被选入摘要。对于这篇样本文章，提取id为9、15、16、18的句子，得到约100个单词的摘要，根据自动评价措施，该摘要在其他15个系统生成的摘要中排名第二。

## 2、评价方法

# 五、为什么TextRank是有效的

直观地说，TextRank工作得很好，因为它不仅依赖于文本单元(顶点)的当前上下文，而且还考虑了从整个文本(图)递归提取的信息。

通过在文本上构建图形，TextRank识别文本中各种实体之间的联系，并实现推荐的概念。一个文本单元推荐其他相关的文本单元，并且基于提出推荐的单元的重要性递归地计算推荐的强度。例如，在关键短语提取应用程序中，共现的单词互相推荐为重要的，而正是共同的上下文支持识别文本中单词之间的连接。在识别文本中重要句子的过程中，一个句子推荐另一个句子，该句子处理类似的概念，对整体理解文本有用。那些被文本中其他句子高度推荐的句子很可能对文本更有帮助，因此会得到更高的分数。

PageRank的“随机冲浪模型”也可以做一个类比，在这个模型中，用户通过跟随任何给定网页的链接来冲浪。在文本建模的背景下，TextRank实现了我们所说的“文本浏览”，这与文本衔接的概念有关：从文本中的某个概念C，我们很可能“遵循”链接到连接的概念——即与当前概念C有关系的概念(无论是词汇关系还是语义关系)。这也涉及到“编织”现象：与词汇相关的事实在语篇的不同部分被分享，这种关系有助于“将语篇编织在一起”。

通过它的迭代机制，TextRank超越了简单的图形连接，它还能够根据链接到的其他文本单元的“重要性”对文本单元进行评分。TextRank为给定应用程序选择的文本单元是文本中相关文本单元最推荐的文本单元，优先考虑最具影响力的文本单元提出的建议，即其他相关单元大力推荐的文本单元。潜在的假设是，在一个有凝聚力的文本片段中，相关的文本单元倾向于形成一个连接的“网络”，近似于人类在话语理解过程中对给定上下文建立的模型。

# 六、结论

在本文中，我们介绍了TextRank——一种基于图形的文本处理排序模型，并展示了它如何成功地用于自然语言应用。特别地，我们提出并评估了两种用于关键词和句子提取的创新无监督方法，并表明TextRank在这些应用程序中实现的准确性与之前提出的最先进算法具有竞争力。TextRank的一个重要方面是，它不需要深入的语言知识，也不需要特定于领域或语言的注释语料库，这使得它可以高度移植到其他领域、流派或语言。